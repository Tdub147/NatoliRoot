<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../css/ToleratorStyle.css">
    <link rel="stylesheet" type="text/css" href="../css/Main.css">
    <link rel="stylesheet" href="../fonts/Valera-Round.css">
    <link rel="stylesheet" href="../fonts/Valera-Round.css">
    <title>Natoli Tolerator</title>
    <link rel="shortcut icon" href="./img/LandingPage_Logo.png">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.0.min.js"></script>
    <script type="text/javascript" src="../js/Tolerator.js"></script>
    <script src="https://unpkg.com/animate-css-grid@latest"></script>
    <script src="https://unpkg.com/cosha"></script>
    <script src="https://unpkg.com/dom-to-image"></script>
    <script type="text/javascript" src="../js/FileSaver.js" ></script>
</head>
<body id="body">
    <form class="grid" autocomplete="off" action="javascript:;" onsubmit="SavePageAsPNG()" onreset="ResetPage()">
        <h1>Natoli Tolerator</h1>
        <div style="width: fit-content;">
            <div class="select-grandparent" style="position:relative">
                <div class="select-parent">
                    <select class="select" style="position:absolute" id="toleranceStyle" oninput="ToleranceStyle_OnInput()">
                        <option value="none">Select Tolerance:</option>
                        <option value="natoliTolerance">Natoli</option>
                        <option value="euTolerance">ISO (European)</option>
                        <option value="pmTolerance">+/-</option>
                    </select>
                </div>
            </div>
            <p class="grid"><br/></p>
            <h3>&nbsp;Size</h3>
            <div class="grid-item size3of8">
                <input type="text" id="width" placeholder="Width" disabled oninput="Calculate()">
            </div>
            <div class="grid-item" style="padding-top: 4px;">X</div>
            <div class="grid-item size3of8">
                <input type="text" id="length" placeholder="Length" disabled oninput="Calculate()">
            </div>
        </div>
        <div class="grid">
            <div id="natoliStyleDiv">
            </div>
            <div id="euStyleDiv" class="grid-item size1of1">
                <div class="grid-item size1of1">
                    <h3>Upper Tip Tolerance</h3>
                </div>
                <div class="grid-item size1of1">
                    <label for="eUStyleUpperTipDeviation">Deviation:</label>
                    <select id="eUStyleUpperTipDeviation" oninput="Calculate()">
                        <option value="0"></option>
                        <option value="a">a</option>
                        <option value="b">b</option>
                        <option value="c">c</option>
                        <option value="cd">cd</option>
                        <option value="d">d</option>
                        <option value="e">e</option>
                        <option value="ef">ef</option>
                        <option value="f">f</option>
                        <option value="fg">fg</option>
                        <option value="g">g</option>
                        <option value="h">h</option>
                        <option value="p">p</option>
                    </select>
                    <label for="eUStyleUpperTipGrade">Grade:</label>
                    <select id="eUStyleUpperTipGrade" oninput="Calculate()">
                        <option value="0"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                    </select>
                </div>
                <div class="grid-item size1of1">
                    <h3>Lower Tip Tolerance</h3>
                </div>
                <div class="grid-item size1of1">
                    <label for="eUStyleLowerTipDeviation">Deviation:</label>
                    <select id="eUStyleLowerTipDeviation" oninput="Calculate()">
                        <option value="0"></option>
                        <option value="a">a</option>
                        <option value="b">b</option>
                        <option value="c">c</option>
                        <option value="cd">cd</option>
                        <option value="d">d</option>
                        <option value="e">e</option>
                        <option value="ef">ef</option>
                        <option value="f">f</option>
                        <option value="fg">fg</option>
                        <option value="g">g</option>
                        <option value="h">h</option>
                        <option value="p">p</option>
                    </select>
                    <label for="eUStyleLowerTipGrade">Grade:</label>
                    <select id="eUStyleLowerTipGrade" oninput="Calculate()">
                        <option value="0"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                    </select>
                </div>
                <div class="grid-item size1of1">
                    <h3>Die Tolerance</h3>
                </div>
                <div class="grid-item size1of1">
                    <label for="eUStyleDieDeviation">Deviation:</label>
                    <select id="eUStyleDieDeviation" oninput="Calculate()">
                        <option value="0"></option>
                        <option value="a">A</option>
                        <option value="b">B</option>
                        <option value="c">C</option>
                        <option value="cd">CD</option>
                        <option value="d">D</option>
                        <option value="e">E</option>
                        <option value="ef">EF</option>
                        <option value="f">F</option>
                        <option value="fg">FG</option>
                        <option value="g">G</option>
                        <option value="h">H</option>
                        <option value="p">P</option>
                    </select>
                    <label for="eUStyleDieGrade">Grade:</label>
                    <select id="eUStyleDieGrade" oninput="Calculate()">
                        <option value="0"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                    </select>
                </div>
            </div>
            <div id="pmStyleDiv" class="grid-item size1of1">
                <div class="grid-item size1of1">
                    <h3>UpperTip Tolerance</h3>
                    <div class="grid-item size1of1">
                        <select id="pmHighUpperTipToleranceSign" oninput="Calculate()">
                            <option value="plus">+</option>
                            <option selected="selected" value="minus">-</option>
                        </select>
                        <input id="pmHighUpperTipTolerance" type="text" placeholder="(mm)" oninput="Calculate()">
                    </div>
                    <div class="grid-item size1of1">
                        <select id="pmLowUpperTipToleranceSign" oninput="Calculate()">
                            <option value="plus">+</option>
                            <option selected value="minus">-</option>
                        </select>
                        <input id="pmLowUpperTipTolerance" type="text" placeholder="(mm)" oninput="Calculate()">
                    </div>
                </div>
                <div class="grid-item size1of1">
                    <h3>Lower Tip Tolerance</h3>
                    <div class="grid-item size1of1">
                        <select id="pmHighLowerTipToleranceSign" oninput="Calculate()">
                            <option value="plus">+</option>
                            <option selected value="minus">-</option>
                        </select>
                        <input id="pmHighLowerTipTolerance" type="text" placeholder="(mm)" oninput="Calculate()">
                    </div>
                    <div class="grid-item size1of1">
                        <select id="pmLowLowerTipToleranceSign" oninput="Calculate()">
                            <option value="plus">+</option>
                            <option selected value="minus">-</option>
                        </select>
                        <input id="pmLowLowerTipTolerance" type="text" placeholder="(mm)" oninput="Calculate()">
                    </div>
                </div>
                <div class="grid-item size1of1">
                    <h3>Die Tolerance</h3>
                    <div class="grid-item size1of1">
                        <select id="pmHighDieToleranceSign" oninput="Calculate()">
                            <option value="plus">+</option>
                            <option value="minus">-</option>
                        </select>
                        <input id="pmHighDieTolerance" type="text" placeholder="(mm)" oninput="Calculate()">
                    </div>
                    <div class="grid-item size1of1">
                        <select id="pmLowDieToleranceSign" oninput="Calculate()">
                            <option value="plus">+</option>
                            <option value="minus">-</option>
                        </select>
                        <input id="pmLowDieTolerance" type="text" placeholder="(mm)" oninput="Calculate()">
                    </div>
                </div>
            </div>
        </div>
        <div class="grid-item size1of1">
            <div class="grid" style="margin-top: .75em; margin-bottom: .75em;">
                <div class="grid-item">
                    Upper tolerance:
                </div>
                <div class="grid-item" id="upperTolerance">
                </div>
            </div>
            <div class="grid" style="margin-top: .75em; margin-bottom: .75em;">
                <div class="grid-item">
                    Lower tolerance:
                </div>
                <div class="grid-item" id="lowerTolerance">
                </div>
            </div>
            <div class="grid" style="margin-top: .75em; margin-bottom: .75em;">
                <div class="grid-item">
                    Die tolerance: &nbsp; &nbsp;
                </div>
                <div class="grid-item" id="dieTolerance">
                </div>
            </div>
        </div>
        <input type="submit" class="button" value="Save Page">
        <input type="reset" class="button" value="Reset">
    </form>
    <br/>
    <br/>
    <br/>
    <br/>
</body>
<script type="text/javascript">
    cosha({
        className: 'colorful-shadow',
        blur: '10px',
        brightness: '125%',
        saturation: '110%',
        x: '2px',
        y: '6px'
    });
</script>
<script type="text/javascript">
    function SavePageAsPNG(){
        var node = document.getElementById('body');
        domtoimage.toPng(node, {bgcolor: "white"})
            .then(function (dataUrl) {
            var link = document.createElement('a');
            var width = document.getElementById('width').value;
            var length = document.getElementById('length').value;
            var tolStyle = "";
            switch(document.getElementById('toleranceStyle').value){
                case "natoliTolerance":
                    tolStyle = "Natoli";
                    width = Number(width).toLocaleString(undefined, { minimumFractionDigits: 4 });
                    length = Number(length).toLocaleString(undefined, { minimumFractionDigits: 4 });
                    break;
                case "euTolerance":
                    var upperTipDeviation = document.getElementById('eUStyleUpperTipDeviation').value;
                    var upperTipGrade = document.getElementById('eUStyleUpperTipGrade').value;
                    var lowerTipDeviation = document.getElementById('eUStyleLowerTipDeviation').value;
                    var lowerTipGrade = document.getElementById('eUStyleLowerTipGrade').value;
                    var dieBoreDeviation = document.getElementById('eUStyleDieDeviation').value;
                    var dieBoreGrade = document.getElementById('eUStyleDieGrade').value;
                    if(upperTipDeviation == "0")
                    {
                        upperTipDeviation="";
                    }
                    if(upperTipGrade == "0")
                    {
                        upperTipGrade="";
                    }
                    if(lowerTipDeviation == "0")
                    {
                        lowerTipDeviation="";
                    }
                    if(lowerTipGrade == "0")
                    {
                        lowerTipGrade="";
                    }
                    if(dieBoreDeviation == "0")
                    {
                        dieBoreDeviation="";
                    }
                    else
                    {
                        dieBoreDeviation=dieBoreDeviation.toUpperCase();
                    }
                    if(dieBoreGrade == "0")
                    {
                        dieBoreGrade="";
                    }
                    tolStyle = "ISO_" +upperTipDeviation+upperTipGrade+lowerTipDeviation+lowerTipGrade+dieBoreDeviation+dieBoreGrade;
                    break;
                case "pmTolerance":
                    var highUpperTipToleranceSign = document.getElementById('pmHighUpperTipToleranceSign').value;
                    var highUpperTipTolerance = Number(document.getElementById('pmHighUpperTipTolerance').value);
                    var lowUpperTipToleranceSign = document.getElementById('pmLowUpperTipToleranceSign').value;
                    var lowUpperTipTolerance = Number(document.getElementById('pmLowUpperTipTolerance').value);
                    var highLowerTipToleranceSign = document.getElementById('pmHighLowerTipToleranceSign').value;
                    var highLowerTipTolerance = Number(document.getElementById('pmHighLowerTipTolerance').value);
                    var lowLowerTipToleranceSign = document.getElementById('pmLowLowerTipToleranceSign').value;
                    var lowLowerTipTolerance = Number(document.getElementById('pmLowLowerTipTolerance').value);
                    var highDieToleranceSign = document.getElementById('pmHighDieToleranceSign').value;
                    var highDieTolerance = Number(document.getElementById('pmHighDieTolerance').value);
                    var lowDieToleranceSign = document.getElementById('pmHighDieToleranceSign').value;
                    var lowDieTolerance = Number(document.getElementById('pmHighDieTolerance').value);
                    if(highUpperTipTolerance != 0)
                    {
                        highUpperTipTolerance = highUpperTipTolerance * 100;
                    }
                    else
                    {
                        highUpperTipToleranceSign = "";
                        highUpperTipTolerance = "";
                    }
                    if(lowUpperTipTolerance != 0)
                    {
                        lowUpperTipTolerance = lowUpperTipTolerance * 100;
                    }
                    else
                    {
                        lowUpperTipToleranceSign = "";
                        lowUpperTipTolerance = "";
                    }
                    if(highLowerTipTolerance != 0)
                    {
                        highLowerTipTolerance = highLowerTipTolerance * 100;
                    }
                    else
                    {
                        highLowerTipToleranceSign = "";
                        highLowerTipTolerance = "";
                    }
                    if(lowLowerTipTolerance != 0)
                    {
                        lowLowerTipTolerance = lowLowerTipTolerance * 100;
                    }
                    else
                    {
                        lowLowerTipToleranceSign = "";
                        lowLowerTipTolerance = "";
                    }
                    if(highDieTolerance != 0)
                    {
                        highDieTolerance = highDieTolerance * 100;
                    }
                    else
                    {
                        highDieToleranceSign = "";
                        highDieTolerance = "";
                    }
                    if(lowDieTolerance != 0)
                    {
                        lowDieTolerance = lowDieTolerance * 100;
                    }
                    else
                    {
                        lowDieToleranceSign = "";
                        lowDieTolerance = "";
                    }
                    tolStyle = "pm"+highUpperTipToleranceSign+highUpperTipTolerance+
                    lowUpperTipToleranceSign+lowUpperTipTolerance+
                    highLowerTipToleranceSign+highLowerTipTolerance+
                    lowLowerTipToleranceSign+lowLowerTipTolerance+
                    highDieToleranceSign+highDieTolerance+
                    lowDieToleranceSign+lowDieTolerance;
                    break;
            }
            var fileName = "";
            if(Number(length) != 0)
            {
                fileName = width + "_X_" + length + "_" + tolStyle+".png";
            }
            else
            {
                fileName = width + "_" + tolStyle+".png";
            }
            link.download = fileName;
            link.href = dataUrl;
            link.click();
        });
    }
</script>
<script type="text/javascript">
    function ResetPage(){
        document.getElementById('width').value = "";
        document.getElementById('length').value = "";
        document.getElementById('toleranceStyle').value = "none";
        Calculate();
        ToleranceStyle_OnInput();
    }
</script>
<script type="text/javascript">
    var x, i, j, selElmnt, a, b, c;
    /* Look for any elements with the class "select-parent": */
    x = document.getElementsByClassName("select-parent");
    for (i = 0; i < x.length; i++) {
    selElmnt = x[i].getElementsByTagName("select")[0];
    /* For each element, create a new DIV that will act as the selected item: */
    a = document.createElement("DIV");
    a.setAttribute("class", "select-selected");
    a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
    x[i].appendChild(a);
    /* For each element, create a new DIV that will contain the option list: */
    b = document.createElement("DIV");
    b.setAttribute("class", "select-items select-hide");
    for (j = 1; j < selElmnt.length; j++) {
        /* For each option in the original select element,
        create a new DIV that will act as an option item: */
        c = document.createElement("DIV");
        c.innerHTML = selElmnt.options[j].innerHTML;
        c.addEventListener("click", function(e) {
            /* When an item is clicked, update the original select box,
            and the selected item: */
            var y, i, k, s, h;
            s = this.parentNode.parentNode.getElementsByTagName("select")[0];
            h = this.parentNode.previousSibling;
            for (i = 0; i < s.length; i++) {
            if (s.options[i].innerHTML == this.innerHTML) {
                s.selectedIndex = i;
                h.innerHTML = this.innerHTML;
                y = this.parentNode.getElementsByClassName("same-as-selected");
                for (k = 0; k < y.length; k++) {
                y[k].removeAttribute("class");
                }
                this.setAttribute("class", "same-as-selected");
                break;
            }
            }
            h.click();
        });
        b.appendChild(c);
    }
    if(i==x.length-1)
    {
        b.setAttribute("style","border-bottom-left-radius: 20px; border-bottom-right-radius: 20px;");
    }
    x[i].appendChild(b);
    a.addEventListener("click", function(e) {
        /* When the select box is clicked, close any other select boxes,
        and open/close the current select box: */
        e.preventDefault();
        this.parentElement.classList.toggle('opened');
        e.stopPropagation();
        closeAllSelect(this);
        this.nextSibling.classList.toggle("select-hide");
        this.classList.toggle("select-arrow-active");
    });
    }

    function closeAllSelect(elmnt) {
    /* A function that will close all select boxes in the document,
    except the current select box: */
    var x, y, i, arrNo = [];
    x = document.getElementsByClassName("select-items");
    y = document.getElementsByClassName("select-selected");
    for (i = 0; i < y.length; i++) {
        if (elmnt == y[i]) {
        arrNo.push(i)
        } else {
        y[i].classList.remove("select-arrow-active");
        }
    }
    for (i = 0; i < x.length; i++) {
        if (arrNo.indexOf(i)) {
        x[i].classList.add("select-hide");
        }
    }
    }

    /* If the user clicks anywhere outside the select box,
    then close all select boxes: */
    document.addEventListener("click", closeAllSelect);
</script>
</html>